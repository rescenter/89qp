!function(){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});for(var h=["webkit","moz"],i=0;i<h.length&&!window.requestAnimationFrame;++i){var c=h[i];window.requestAnimationFrame=window[c+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c+"CancelAnimationFrame"]||window[c+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var g=0;window.requestAnimationFrame=function(h){var c=Date.now(),_=Math.max(g+16,c);return setTimeout(function(){h(g=_)},_-c)},window.cancelAnimationFrame=clearTimeout}}(),function(){function h(h){return 1-Math.sqrt(1-h*h)}function c(h,c,g){h.addEventListener(c,g,!1)}function g(h,c,g){h.removeEventListener(c,g)}function _(h,c){for(var i in c)if(c[i].test(h[i]))return!0;return!1}var w,M,T,y,b=document.createElement("div").style;if("transform"in b)y="transform",w="transitionend",M="transitionDuration",T="transitionTimingFunction";else{if(!("webkitTransform"in b))throw"please use a modern browser";y="webkitTransform",w="webkitTransitionEnd",M="webkitTransitionDuration",T="webkitTransitionTimingFunction"}var F="cubic-bezier(0.1, 0.57, 0.1, 1)",D=function(h){if(this.scroller=h.target,this.element="string"==typeof h.touch?document.querySelector(h.touch):h.touch,this.vertical=this._getValue(h.vertical,!0),this.property=h.property,this.preventDefault=this._getValue(h.preventDefault,!0),this.sensitivity=this._getValue(h.sensitivity,1),this.lockDirection=this._getValue(h.lockDirection,!0),this.initialValue=this._getValue(h.initialValue,this.scroller[this.property]),this.scroller[this.property]=this.initialValue,this.moveFactor=this._getValue(h.moveFactor,1),this.factor=this._getValue(h.factor,1),this.outFactor=this._getValue(h.outFactor,.3),this.min=h.min,this.max=h.max,this.maxRegion=this._getValue(h.maxRegion,60),this.deceleration=6e-4,this.maxRegion=this._getValue(h.maxRegion,600),this.springMaxRegion=this._getValue(h.springMaxRegion,60),this.change=h.change||function(){},this.touchEnd=h.touchEnd||function(){},this.touchStart=h.touchStart||function(){},this.touchMove=h.touchMove||function(){},this.touchCancel=h.touchMove||function(){},this.animationEnd=h.animationEnd||function(){},this.preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},this.hasMin=!(void 0===this.min),this.hasMax=!(void 0===this.max),this.isTouchStart=!1,this.step=h.step,this.inertia=this._getValue(h.inertia,!0),this.maxSpeed=h.maxSpeed,this.hasMaxSpeed=!(void 0===this.maxSpeed),this.hasMax&&this.hasMin){if(this.min>this.max)throw"min value can't be greater than max value";this.currentPage=Math.round((this.max-this.scroller[this.property])/this.step)}this._startHandler=this._start.bind(this),this._moveHandler=this._move.bind(this),this._transitionEndHandler=this._transitionEnd.bind(this),this._endHandler=this._end.bind(this),this._cancelHandler=this._cancel.bind(this),c(this.element,"touchstart",this._startHandler),c(this.scroller,w,this._transitionEndHandler),c(window,"touchmove",this._moveHandler),c(window,"touchend",this._endHandler),c(window,"touchcancel",this._cancelHandler),this._endCallbackTag=!0,this._endTimeout=null};D.prototype={_getValue:function(h,c){return void 0===h?c:h},_transitionEnd:function(){if(this._triggerTransitionEnd){var h=this.scroller[this.property];return h<this.min?void this.to(this.min,600,F):h>this.max?void this.to(this.max,600,F):void(this.step?(this.correction(),this._endCallbackTag&&(this._endTimeout=setTimeout(function(){this.animationEnd.call(this,h),cancelAnimationFrame(this.tickID)}.bind(this),400),this._endCallbackTag=!1)):(this.animationEnd.call(this,h),cancelAnimationFrame(this.tickID)))}},_cancelAnimation:function(){this.scroller.style[M]="0ms",this.scroller[this.property]=this.getComputedPosition()},getComputedPosition:function(){var h=window.getComputedStyle(this.scroller,null);return h=h[y].split(")")[0].split(", "),this.vertical?+(h[13]||h[5]):+(h[12]||h[4])},_tick:function(){this.change.call(this,this.getComputedPosition()),this.tickID=requestAnimationFrame(this._tick.bind(this))},stop:function(){cancelAnimationFrame(this.tickID),this._cancelAnimation(),clearTimeout(this._endTimeout),this.hasMax&&this.hasMin&&(this.currentPage=Math.round((this.max-this.scroller[this.property])/this.step))},_start:function(h){cancelAnimationFrame(this.tickID),this._tick(),this._endCallbackTag=!0,this.isTouchStart=!0,this._firstTouchMove=!0,this._preventMove=!1,this.touchStart.call(this,h,this.scroller[this.property]),this._cancelAnimation(),clearTimeout(this._endTimeout),this.hasMax&&this.hasMin&&(this.currentPage=Math.round((this.max-this.scroller[this.property])/this.step)),this.startTime=(new Date).getTime(),this._startX=this.preX=h.touches[0].pageX,this._startY=this.preY=h.touches[0].pageY,this.start=this.vertical?this.preY:this.preX},_move:function(h){if(this.isTouchStart){var c=Math.abs(h.touches[0].pageX-this._startX),g=Math.abs(h.touches[0].pageY-this._startY);if(this._firstTouchMove&&this.lockDirection){var w=c-g;w>0&&this.vertical?this._preventMove=!0:0>w&&!this.vertical&&(this._preventMove=!0),this._firstTouchMove=!1}if(10>c&&10>g)return;if(!this._preventMove){var f=this.moveFactor,d=(this.vertical?h.touches[0].pageY-this.preY:h.touches[0].pageX-this.preX)*this.sensitivity;this.hasMax&&this.scroller[this.property]>this.max&&d>0?f=this.outFactor:this.hasMin&&this.scroller[this.property]<this.min&&0>d&&(f=this.outFactor),d*=f,this.preX=h.touches[0].pageX,this.preY=h.touches[0].pageY,this.scroller[this.property]+=d;var M=(new Date).getTime();M-this.startTime>300&&(this.startTime=M,this.start=this.vertical?this.preY:this.preX),this.touchMove.call(this,h,this.scroller[this.property])}this.preventDefault&&!_(h.target,this.preventDefaultException)&&h.preventDefault()}},_end:function(c){if(this.isTouchStart){var g=this,_=this.scroller[this.property];if(this.touchEnd.call(this,c,_)===!1)return this._triggerTransitionEnd=!1,void cancelAnimationFrame(this.tickID);if(this._triggerTransitionEnd=!0,this.hasMax&&_>this.max)this.to(this.max,600,F);else if(this.hasMin&&_<this.min)this.to(this.min,600,F);else if(this.inertia&&!this._preventMove){var w=(new Date).getTime()-this.startTime;if(300>w){var M=((this.vertical?c.changedTouches[0].pageY:c.changedTouches[0].pageX)-this.start)*this.sensitivity,T=Math.abs(M)/w,y=this.factor*T;this.hasMaxSpeed&&y>this.maxSpeed&&(y=this.maxSpeed);var b=_+y*y/(2*this.deceleration)*(0>M?-1:1),D=1;b<this.min?b<this.min-this.maxRegion?(D=h((_-this.min+this.springMaxRegion)/(_-b)),b=this.min-this.springMaxRegion):(D=h((_-this.min+this.springMaxRegion*(this.min-b)/this.maxRegion)/(_-b)),b=this.min-this.springMaxRegion*(this.min-b)/this.maxRegion):b>this.max&&(b>this.max+this.maxRegion?(D=h((this.max+this.springMaxRegion-_)/(b-_)),b=this.max+this.springMaxRegion):(D=h((this.max+this.springMaxRegion*(b-this.max)/this.maxRegion-_)/(b-_)),b=this.max+this.springMaxRegion*(b-this.max)/this.maxRegion));var E=Math.round(T/g.deceleration)*D;g.to(Math.round(b),E,F)}else g.step&&g.correction()}else g.step&&g.correction();this.isTouchStart=!1}},_cancel:function(h){cancelAnimationFrame(this.tickID),this.step&&this.correction(),this.touchCancel.call(this,h)},to:function(h,c,g){var _=this.scroller,w=this.property;_.style[M]=this._getValue(c,600)+"ms",_.style[T]=g||F,_[w]=h},correction:function(){var h,c=window.getComputedStyle(this.scroller)[y],g=parseInt(this.vertical?c.split(",")[13]:c.split(",")[12]),_=Math.floor(Math.abs(g/this.step)),w=g%this.step;Math.abs(w)>this.step/2?(h=(0>g?-1:1)*(_+1)*this.step,h>this.max&&(h=this.max),h<this.min&&(h=this.min),this.to(h,400,F)):(h=(0>g?-1:1)*_*this.step,h>this.max&&(h=this.max),h<this.min&&(h=this.min),this.to(h,400,F))},destroy:function(){g(this.element,"touchstart",this._startHandler),g(this.scroller,w,this._transitionEndHandler),g(window,"touchmove",this._moveHandler),g(window,"touchend",this._endHandler),g(window,"touchcancel",this._cancelHandler)}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=D:window.AlloyTouch=D}();